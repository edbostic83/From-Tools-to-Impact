<script>
    /* ---------- tiny helpers ---------- */
    const $ = (id) => document.getElementById(id);
    const show = (id) => { const el = $(id); if (el) el.classList.remove('hidden'); };
    const text = (id) => ($(id)?.value || '').trim();
    const setOut = (id, s) => { const el = $(id); if (el) { el.textContent = s; show(id); } };
    const dl = (filename, text) => {
      const blob = new Blob([text], {type: 'text/plain'});
      const a = document.createElement('a'); a.href = URL.createObjectURL(blob);
      a.download = filename; a.click(); URL.revokeObjectURL(a.href);
    };
    const copyTxt = async (s) => { try { await navigator.clipboard.writeText(s); alert('Copied.'); } catch { alert('Copy failed.'); } };
    const mail = (subject, body) => { location.href = `mailto:edbostic83@gmail.com?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`; };
    
    /* ---------- help chips ---------- */
    window.toggleChip = (btn) => {
      const wrap = btn.closest('.chip-wrap'); if (!wrap) return;
      wrap.classList.toggle('show');
      setTimeout(() => wrap.classList.remove('show'), 3500);
    };
    
    /* ---------- Impact Ladder tabs ---------- */
    window.switchTab = (who) => {
      (who==='student' ? $('ladder-lea') : $('ladder-stu'))?.classList.add('hidden');
      (who==='student' ? $('ladder-stu') : $('ladder-lea'))?.classList.remove('hidden');
      if (who==='student') { $('tab-stu')?.classList.add('border-b-2','border-[--gold]'); $('tab-lea')?.classList.remove('border-b-2','border-[--gold]'); }
      else { $('tab-lea')?.classList.add('border-b-2','border-[--gold]'); $('tab-stu')?.classList.remove('border-b-2','border-[--gold]'); }
    };
    window.ladderPrefill = (who) => {
      // gentle prefill to the planner from ladder examples
      $('toolName') && ($('toolName').value = who==='student' ? 'Flip / LLM' : 'Data dashboard');
      $('targetBehavior') && ($('targetBehavior').value = who==='student' ? 'Peer feedback every Wednesday' : '15-min weekly data huddle');
      $('measurableOutcome') && ($('measurableOutcome').value = who==='student' ? '+1 rubric level in 4 weeks' : '+5% STAAR item mastery in 6 weeks');
      $('owner') && ($('owner').value = who==='student' ? '6th ELA team • weekly' : 'Campus ILT • Fridays');
    };
    
    /* ---------- Planner ---------- */
    window.generatePlanner = () => {
      const plan = [
        `Tool: ${text('toolName') || '(name the app/platform)'}`,
        `Use → Habit: ${text('targetBehavior') || '(what people will do, on a cadence)'}`,
        `Outcome (2–6 wks): ${text('measurableOutcome') || '(one measurable change)'}`,
        `Owner + Cadence: ${text('owner') || '(who + how often)'}`,
        `Standards/Policy: ${text('standardsPolicy') || '(paste exact wording: TEKS/EDGAR/local)'}`,
      ].join('\n');
      setOut('planner-output', plan);
    };
    window.openEvidenceModal = () => {
      alert('Evidence ideas:\n• Before/after artifacts\n• Counts (submissions, completions)\n• Short surveys or rubric snapshots\n• Screenshots/links to the work');
    };
    window.downloadPlan   = () => dl('tool-to-impact-plan.txt', $('planner-output')?.textContent || '');
    window.copyPlan       = () => copyTxt($('planner-output')?.textContent || '');
    window.emailElementText = (id, subject) => mail(subject, $(id)?.textContent || '');
    
    /* ---------- Data Prep Coach ---------- */
    window.makeDataSpec = () => {
      const spec = [
        `Goal/Decision: ${text('dp_goal')}`,
        `Primary metric: ${text('dp_outcome')}`,
        `Grain: ${text('dp_unit')}`,
        `Window: ${text('dp_window')}`,
        `Sources: ${text('dp_sources')}`,
        `Join keys: ${text('dp_ids')}`,
        `Fields: ${text('dp_fields')}`,
        `Filters: ${text('dp_filters')}`,
        `Privacy: ${text('dp_privacy')}`,
        `Quality: ${text('dp_quality')}`
      ].join('\n');
      setOut('dp_output', spec);
    };
    window.downloadCSVTemplate = () => {
      const cols = (text('dp_fields') || 'student_id,date,present,period,reason_code').split(/\s*,\s*/).join(',');
      dl('template.csv', cols + '\n');
    };
    window.downloadPrepChecklist = () => {
      const ck = `Checklist
    [ ] Fields named and ordered
    [ ] Grain matches question
    [ ] IDs consistent across tables
    [ ] Filters declared
    [ ] Privacy (no PII in uploads)
    [ ] Quality checks (missing/outliers)`;
      dl('data-prep-checklist.txt', ck);
    };
    window.copyDataPrompt = () => {
      const p = `You are a data prep coach. Using the spec below, generate:
    1) a schema with column names/types,
    2) sample rows,
    3) a quality-check list.
    
    Spec:
    ${$('dp_output')?.textContent || '(fill the form first)'}`;
      copyTxt(p);
    };
    
/* ---------- Platform Finder ---------- */
window.generatePlatformRec = () => {
  const goal = $('pf_goal')?.value || 'create';
  const inputs = Array.from($('pf_inputs')?.selectedOptions || []).map(o => o.value);
  const outputs = Array.from($('pf_outputs')?.selectedOptions || []).map(o => o.value);
  const flags = [
    $('pf_privacy')?.checked ? 'FERPA/PII' : null,
    $('pf_blocked')?.checked ? 'no installs' : null,
    $('pf_no_cost')?.checked ? 'free only' : null,
    $('pf_low_skill')?.checked ? 'low skill' : null,
    $('pf_offline')?.checked ? 'offline/export' : null,
  ].filter(Boolean);
  const collab = $('pf_collab')?.value;
  const time = $('pf_time')?.value, risk = $('pf_risk')?.value;

  const rec = `Goal: ${goal}
Inputs: ${inputs.join(', ') || 'text'}
Outputs: ${outputs.join(', ') || 'document'}
Constraints: ${flags.join(' | ') || '—'}
Collaboration: ${collab} | Time: ${time} | Risk: ${risk}

Try:
• General LLM (ChatGPT/Claude) for drafting.
• Canva or Gamma for slides/docs from prompts.
• Sheets/Excel for CSV analysis if data is sensitive.
Search string:
"${goal} ${inputs.join(' ')} to ${outputs.join(' ')} education ferpa template"`;

  setOut('pf_output', rec);
};

window.downloadPFChecklist = () => dl('platform-checklist.txt',
`Platform checklist
[ ] Student-data compliant
[ ] Export/download works
[ ] Login friction acceptable
[ ] Team/stakeholder workflow supported
[ ] Cost: free/pilot/budgeted
[ ] Time-to-value <= chosen window`);

window.copySearchString = () => {
  const goal = $('pf_goal')?.value || 'create';
  const inputs = Array.from($('pf_inputs')?.selectedOptions || []).map(o => o.value);
  const outputs = Array.from($('pf_outputs')?.selectedOptions || []).map(o => o.value);
  copyTxt(`"${goal} ${inputs.join(' ')} to ${outputs.join(' ')} education ferpa template"`);
};

      const goal = $('#pf_goal')?.value || 'create';
      const inputs = Array.from($('#pf_inputs')?.selectedOptions||[]).map(o=>o.value);
      const outputs = Array.from($('#pf_outputs')?.selectedOptions||[]).map(o=>o.value);
      copyTxt(`"${goal} ${inputs.join(' ')} to ${outputs.join(' ')} education ferpa template"`);
    };
    
    /* ---------- Guided Mode (minimal) ---------- */
    const guided = {
      teacher: ['Pick tool', 'Write habit', 'Set outcome', 'Choose evidence'],
      leader:  ['Pick dashboard', 'Schedule huddles', 'Name metric movement', 'Decide artifacts'],
      central: ['Pick workflow', 'Cadence + owners', 'Risk/Policy', 'Evidence']
    };
    let gWho = 'teacher', gStep = 0;
    window.startGuided = (who) => {
      gWho = who; gStep = 0;
      $('guided-panel')?.classList.remove('hidden');
      $('guided-why').textContent = 
        who==='central' ? 'Lock a weekly habit that survives leadership churn.' :
        who==='leader'  ? 'Tiny routines > giant plans. Ship a cadence.' :
                           'Aim for behavior change, not “played with a tool.”';
      window.nextGuided();
    };
    window.nextGuided = () => {
      const steps = guided[gWho]; if (!steps) return;
      $('guided-step-num').textContent = gStep+1;
      $('guided-step-title').textContent = steps[gStep];
      $('guided-step-body').textContent = 'Use the fields below to fill this step; advance when you’ve written a concrete, observable behavior.';
      gStep = (gStep + 1) % steps.length;
    };
    window.prevGuided = () => { gStep = Math.max(0, gStep-1); window.nextGuided(); };
    
    /* ---------- Connect buttons (Instagram/Twitter/Email) ---------- */
    window.openInsta = () => window.open('https://instagram.com/cultureaintjustcupcaskes','_blank');
    window.openTwitter = () => window.open('https://twitter.com/Msedbostic','_blank');
    window.openHireMe = () => {
      const body = `Hello Elizabeth,%0D%0A%0D%0AI'm interested in PD/consulting.%0D%0A
    Role/Audience:%0D%0A
    Goal/Outcome:%0D%0A
    Dates/Timeline:%0D%0A
    Constraints (FERPA, cost, etc.):%0D%0A
    Thanks!`;
      location.href = `mailto:edbostic83@gmail.com?subject=PD/Consulting%20Inquiry&body=${body}`;
    };
    </script>
</body>
